# PE (Windows) åç«¯

PE (Portable Executable) åç«¯é€šè¿‡ Gaia ç»Ÿä¸€æ¥å£ä¸º Windows å¹³å°æä¾›ç¼–è¯‘æ”¯æŒï¼Œç”ŸæˆåŸç”Ÿå¯æ‰§è¡Œæ–‡ä»¶ï¼Œæ”¯æŒ EXE å’Œ DLL æ ¼å¼ã€‚

## æ¦‚è¿°

```mermaid
graph TD
    A[Gaia Assembler] --> B(PE Backend)
    B --> C{PE File Generation}
    C --> D[Executable/DLL Output]
```

PE åç«¯é€šè¿‡ Gaia ç»Ÿä¸€ç¼–è¯‘æ¥å£ä¸º Windows å¹³å°æä¾›ç¼–è¯‘æ”¯æŒï¼Œç”Ÿæˆæ ‡å‡†çš„ PE æ ¼å¼äºŒè¿›åˆ¶æ–‡ä»¶ã€‚é€šè¿‡ Gaia çš„ PE åç«¯ï¼Œæ‚¨å¯ä»¥ï¼š

- ç”Ÿæˆé«˜æ€§èƒ½çš„åŸç”Ÿ Windows åº”ç”¨ç¨‹åº
- åˆ›å»ºåŠ¨æ€é“¾æ¥åº“ (DLL) ä¾›å…¶ä»–ç¨‹åºä½¿ç”¨
- ä¸ Windows API å’Œç³»ç»ŸæœåŠ¡æ·±åº¦é›†æˆ
- äº«å—é›¶è¿è¡Œæ—¶å¼€é”€çš„åŸç”Ÿæ‰§è¡Œæ€§èƒ½

## å¿«é€Ÿç¤ºä¾‹

```rust
use gaia_assembler::pe::{PeAssembler, WriterConfig};

// åˆ›å»ºç®€å•çš„ Hello World ç¨‹åº
let mut assembler = PeAssembler::new_console_app();
assembler.set_entry_point(0x1000);

// æ·»åŠ ä»£ç æ®µ
let text_section = assembler.add_section(".text");
text_section.add_hello_world_code();

// æ·»åŠ å¯¼å…¥
assembler.add_import("msvcrt.dll", & ["printf"]);

// ç”Ÿæˆ PE æ–‡ä»¶
let pe_data = assembler.build(WriterConfig::default ()) ?;
std::fs::write("hello.exe", pe_data) ?;
```

## æ–‡æ¡£å¯¼èˆª

### ğŸš€ å¿«é€Ÿå¼€å§‹

- **[å…¥é—¨æŒ‡å—](./getting-started.md)** - ç¯å¢ƒé…ç½®å’Œç¬¬ä¸€ä¸ª PE ç¨‹åº
- **[åŸºç¡€æ¦‚å¿µ](./concepts.md)** - PE æ ¼å¼åŸºç¡€çŸ¥è¯†å’Œæ ¸å¿ƒæ¦‚å¿µ

### ğŸ—ï¸ æ ¸å¿ƒåŠŸèƒ½

- **[PE æ–‡ä»¶ç»“æ„](./file-structure.md)** - DOS å¤´ã€NT å¤´ã€èŠ‚åŒºè¯¦è§£
- **[åŸºç¡€æ¦‚å¿µ](./concepts.md)** - PE æ ¼å¼æ ¸å¿ƒæ¦‚å¿µå’ŒåŸç†

### ğŸ”— ç³»ç»Ÿé›†æˆ

- **[å…¥é—¨æŒ‡å—](./getting-started.md)** - ç¯å¢ƒé…ç½®å’ŒåŸºç¡€ä½¿ç”¨
- **[ç”¨æˆ·æŒ‡å—](../../user-guide/index.md)** - Gaia æ¡†æ¶é€šç”¨åŠŸèƒ½

### âš¡ é«˜çº§ç‰¹æ€§

- **[ç”¨æˆ·æŒ‡å—](../../user-guide/index.md)** - æ€§èƒ½ä¼˜åŒ–å’Œè°ƒè¯•æ”¯æŒ
- **[ç»´æŠ¤æŒ‡å—](../../maintenance/index.md)** - å®‰å…¨æ€§å’Œå·¥å…·é›†æˆ

### ğŸ› ï¸ å¼€å‘å·¥å…·

- **[ç»´æŠ¤æŒ‡å—](../../maintenance/troubleshooting.md)** - å¸¸è§é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆ
- **[å¼€å‘è€…æŒ‡å—](../../developer-guide/index.md)** - å¼€å‘å·¥å…·å’Œé›†æˆ

## æ ¸å¿ƒç‰¹æ€§

### PE æ–‡ä»¶ç”Ÿæˆ

- æ ‡å‡† PE/COFF æ ¼å¼æ”¯æŒ
- å¯æ‰§è¡Œæ–‡ä»¶ (.exe) å’ŒåŠ¨æ€é“¾æ¥åº“ (.dll)
- æ§åˆ¶å°å’Œ GUI åº”ç”¨ç¨‹åº
- 32ä½å’Œ64ä½æ¶æ„æ”¯æŒ

### Windows é›†æˆ

- Kernel32ã€User32 ç­‰ç³»ç»Ÿ DLL é›†æˆ
- Windows API ç›´æ¥è°ƒç”¨
- COM ç»„ä»¶æ”¯æŒ
- .NET äº’æ“ä½œæ€§

### æ€§èƒ½ä¼˜åŠ¿

- ç›´æ¥æœºå™¨ç æ‰§è¡Œï¼Œæ— è§£é‡Šå¼€é”€
- æœ€å°åŒ–å¯åŠ¨æ—¶é—´
- ä¼˜åŒ–çš„å†…å­˜å¸ƒå±€
- åŸç”Ÿç³»ç»Ÿè°ƒç”¨æ€§èƒ½

## é€‚ç”¨åœºæ™¯

### ç³»ç»Ÿçº§åº”ç”¨

- è®¾å¤‡é©±åŠ¨ç¨‹åº
- ç³»ç»ŸæœåŠ¡å’Œå®ˆæŠ¤è¿›ç¨‹
- åº•å±‚å·¥å…·å’Œå®ç”¨ç¨‹åº

### é«˜æ€§èƒ½åº”ç”¨

- æ¸¸æˆå¼•æ“å’Œå›¾å½¢åº”ç”¨
- ç§‘å­¦è®¡ç®—å’Œæ•°å€¼åˆ†æ
- å®æ—¶ç³»ç»Ÿå’ŒåµŒå…¥å¼åº”ç”¨

### ä¼ä¸šåº”ç”¨

- æ¡Œé¢åº”ç”¨ç¨‹åº
- æœåŠ¡å™¨ç«¯ç»„ä»¶
- æ•°æ®åº“å¼•æ“å’Œä¸­é—´ä»¶

## ç¤¾åŒºæ”¯æŒ

- **GitHub ä»“åº“**: [project-gaia](https://github.com/nyar-vm/project-gaia)
- **é—®é¢˜åé¦ˆ**: [Issues](https://github.com/nyar-vm/project-gaia/issues)
- **è®¨è®ºç¤¾åŒº**: [Discussions](https://github.com/nyar-vm/project-gaia/discussions)
- **æ–‡æ¡£è´¡çŒ®**: [å¼€å‘è€…æŒ‡å—](../../developer-guide/index.md)

## ä¸‹ä¸€æ­¥

1. ä» **[å…¥é—¨æŒ‡å—](./getting-started.md)** å¼€å§‹å­¦ä¹  PE åç«¯çš„åŸºç¡€ä½¿ç”¨
2. äº†è§£ **[åŸºç¡€æ¦‚å¿µ](./concepts.md)** æŒæ¡ PE æ ¼å¼çš„æ ¸å¿ƒçŸ¥è¯†
3. æ·±å…¥ **[æ–‡ä»¶ç»“æ„](./file-structure.md)** å­¦ä¹  PE æ–‡ä»¶çš„å†…éƒ¨ç»„ç»‡
4. æ¢ç´¢ **[ç”¨æˆ·æŒ‡å—](../../user-guide/index.md)** äº†è§£ Gaia æ¡†æ¶åŠŸèƒ½

---

*æœ¬æ–‡æ¡£æŒç»­æ›´æ–°ä¸­ï¼Œå¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œæ¬¢è¿æäº¤ Issue æˆ– Pull Requestã€‚*