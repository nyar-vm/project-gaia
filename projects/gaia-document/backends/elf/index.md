# ELF (Linux/Unix) åç«¯

ELF (Executable and Linkable Format) åç«¯é€šè¿‡ Gaia ç»Ÿä¸€æ¥å£ä¸º Linux å’Œå…¶ä»– Unix ç³»ç»Ÿæä¾›ç¼–è¯‘æ”¯æŒï¼Œç”ŸæˆåŸç”Ÿå¯æ‰§è¡Œæ–‡ä»¶ï¼Œæ”¯æŒé™æ€å’ŒåŠ¨æ€é“¾æ¥ã€‚

## æ¦‚è¿°

```mermaid
graph TD
    A[Gaia Assembler] --> B(ELF Backend)
    B --> C{ELF File Generation}
    C --> D[Executable/Shared Library]
```

ELF åç«¯é€šè¿‡ Gaia ç»Ÿä¸€ç¼–è¯‘æ¥å£ä¸º Linux å’Œ Unix å¹³å°æä¾›ç¼–è¯‘æ”¯æŒï¼Œç”Ÿæˆæ ‡å‡†çš„ ELF æ ¼å¼äºŒè¿›åˆ¶æ–‡ä»¶ã€‚é€šè¿‡ Gaia çš„ ELF åç«¯ï¼Œæ‚¨å¯ä»¥ï¼š

- ç”Ÿæˆé«˜æ€§èƒ½çš„åŸç”Ÿ Linux/Unix åº”ç”¨ç¨‹åº
- åˆ›å»ºå…±äº«åº“ (.so) ä¾›å…¶ä»–ç¨‹åºä½¿ç”¨
- ä¸ Linux å†…æ ¸å’Œç³»ç»ŸæœåŠ¡æ·±åº¦é›†æˆ
- äº«å—é›¶è¿è¡Œæ—¶å¼€é”€çš„åŸç”Ÿæ‰§è¡Œæ€§èƒ½
- æ”¯æŒå¤šç§å¤„ç†å™¨æ¶æ„ (x86-64, ARM64, RISC-V ç­‰)

## å¿«é€Ÿç¤ºä¾‹

```rust
use gaia_assembler::elf::{ElfAssembler, WriterConfig};

// åˆ›å»ºç®€å•çš„ Hello World ç¨‹åº
let mut assembler = ElfAssembler::new_executable();
assembler.set_machine(elf::EM_X86_64);
assembler.set_entry_point(0x401000);

// æ·»åŠ ä»£ç æ®µ
let text_section = assembler.add_section(".text");
text_section.add_hello_world_syscall();

// æ·»åŠ æ•°æ®æ®µ
let data_section = assembler.add_section(".data");
data_section.add_string("Hello, World!\n");

// ç”Ÿæˆ ELF æ–‡ä»¶
let elf_data = assembler.build(WriterConfig::default ()) ?;
std::fs::write("hello", elf_data) ?;
```

## æ–‡æ¡£å¯¼èˆª

### ğŸš€ å¿«é€Ÿå¼€å§‹

- **[å…¥é—¨æŒ‡å—](./getting-started.md)** - ç¯å¢ƒé…ç½®å’Œç¬¬ä¸€ä¸ª ELF ç¨‹åº
- **[åŸºç¡€æ¦‚å¿µ](./concepts.md)** - ELF æ ¼å¼åŸºç¡€çŸ¥è¯†å’Œæ ¸å¿ƒæ¦‚å¿µ

### ğŸ—ï¸ æ ¸å¿ƒåŠŸèƒ½

- **[ELF æ–‡ä»¶ç»“æ„](./file-structure.md)** - ELF å¤´ã€ç¨‹åºå¤´ã€èŠ‚åŒºè¯¦è§£
- **[åŸºç¡€æ¦‚å¿µ](./concepts.md)** - ELF æ ¼å¼æ ¸å¿ƒæ¦‚å¿µå’ŒåŸç†

### ğŸ”— ç³»ç»Ÿé›†æˆ

- **[å…¥é—¨æŒ‡å—](./getting-started.md)** - ç¯å¢ƒé…ç½®å’ŒåŸºç¡€ä½¿ç”¨
- **[ç”¨æˆ·æŒ‡å—](../../user-guide/index.md)** - Gaia æ¡†æ¶é€šç”¨åŠŸèƒ½

### âš¡ é«˜çº§ç‰¹æ€§

- **[ç”¨æˆ·æŒ‡å—](../../user-guide/index.md)** - æ€§èƒ½ä¼˜åŒ–å’Œè°ƒè¯•æ”¯æŒ
- **[ç»´æŠ¤æŒ‡å—](../../maintenance/index.md)** - å®‰å…¨æ€§å’Œå·¥å…·é›†æˆ

### ğŸ› ï¸ å¼€å‘å·¥å…·

- **[ç»´æŠ¤æŒ‡å—](../../maintenance/troubleshooting.md)** - å¸¸è§é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆ
- **[å¼€å‘è€…æŒ‡å—](../../developer-guide/index.md)** - å¼€å‘å·¥å…·å’Œé›†æˆ

## æ ¸å¿ƒç‰¹æ€§

### ELF æ–‡ä»¶ç”Ÿæˆ

- æ ‡å‡† ELF æ ¼å¼æ”¯æŒ (32ä½å’Œ64ä½)
- å¯æ‰§è¡Œæ–‡ä»¶ (ET_EXEC) å’Œå…±äº«åº“ (ET_DYN)
- å¯é‡å®šä½æ–‡ä»¶ (ET_REL) å’Œæ ¸å¿ƒè½¬å‚¨ (ET_CORE)
- å¤šæ¶æ„æ”¯æŒ (x86-64, ARM64, RISC-V, MIPS)

### ç³»ç»Ÿé›†æˆ

- Linux ç³»ç»Ÿè°ƒç”¨ç›´æ¥æ¥å£
- POSIX API å’Œ GNU C åº“é›†æˆ
- å†…æ ¸æ¨¡å—å’Œè®¾å¤‡é©±åŠ¨æ”¯æŒ
- å®¹å™¨å’Œè™šæ‹ŸåŒ–ç¯å¢ƒå…¼å®¹

### é“¾æ¥æœºåˆ¶

- é™æ€é“¾æ¥å’ŒåŠ¨æ€é“¾æ¥
- ä½ç½®æ— å…³ä»£ç  (PIC) ç”Ÿæˆ
- å»¶è¿Ÿç»‘å®šå’Œç¬¦å·è§£æ
- é“¾æ¥æ—¶ä¼˜åŒ– (LTO) æ”¯æŒ

## é€‚ç”¨åœºæ™¯

### ç³»ç»Ÿçº§ç¼–ç¨‹

- æ“ä½œç³»ç»Ÿå†…æ ¸å’Œæ¨¡å—
- è®¾å¤‡é©±åŠ¨ç¨‹åº
- ç³»ç»ŸæœåŠ¡å’Œå®ˆæŠ¤è¿›ç¨‹
- åº•å±‚å·¥å…·å’Œå®ç”¨ç¨‹åº

### é«˜æ€§èƒ½è®¡ç®—

- ç§‘å­¦è®¡ç®—å’Œæ•°å€¼åˆ†æ
- å¹¶è¡Œè®¡ç®—å’Œ GPU åŠ é€Ÿ
- å®æ—¶ç³»ç»Ÿå’ŒåµŒå…¥å¼åº”ç”¨
- ç½‘ç»œæœåŠ¡å™¨å’Œæ•°æ®åº“å¼•æ“

### åº”ç”¨ç¨‹åºå¼€å‘

- æ¡Œé¢åº”ç”¨ç¨‹åº (GTK, Qt)
- å‘½ä»¤è¡Œå·¥å…·å’Œè„šæœ¬
- æ¸¸æˆå¼•æ“å’Œå›¾å½¢åº”ç”¨
- å®¹å™¨åŒ–åº”ç”¨å’Œå¾®æœåŠ¡

## æ¶æ„æ”¯æŒ

### x86-64 (AMD64)

- å®Œæ•´çš„æŒ‡ä»¤é›†æ”¯æŒ
- SSE/AVX å‘é‡æŒ‡ä»¤
- ç³»ç»Ÿè°ƒç”¨ä¼˜åŒ–
- æ€§èƒ½è®¡æ•°å™¨é›†æˆ

### ARM64 (AArch64)

- ARMv8 æŒ‡ä»¤é›†
- NEON å‘é‡å¤„ç†
- ç§»åŠ¨å’ŒåµŒå…¥å¼ä¼˜åŒ–
- ä½åŠŸè€—ç‰¹æ€§

### RISC-V

- å¼€æºæŒ‡ä»¤é›†æ¶æ„
- æ¨¡å—åŒ–æ‰©å±•æ”¯æŒ
- å­¦æœ¯å’Œç ”ç©¶åº”ç”¨
- æ–°å…´ç¡¬ä»¶å¹³å°

## ç¤¾åŒºæ”¯æŒ

- **GitHub ä»“åº“**: [project-gaia](https://github.com/nyar-vm/project-gaia)
- **é—®é¢˜åé¦ˆ**: [Issues](https://github.com/nyar-vm/project-gaia/issues)
- **è®¨è®ºç¤¾åŒº**: [Discussions](https://github.com/nyar-vm/project-gaia/discussions)
- **æ–‡æ¡£è´¡çŒ®**: [å¼€å‘è€…æŒ‡å—](../../developer-guide/index.md)

## ä¸‹ä¸€æ­¥

1. ä» **[å…¥é—¨æŒ‡å—](./getting-started.md)** å¼€å§‹å­¦ä¹  ELF åç«¯çš„åŸºç¡€ä½¿ç”¨
2. äº†è§£ **[åŸºç¡€æ¦‚å¿µ](./concepts.md)** æŒæ¡ ELF æ ¼å¼çš„æ ¸å¿ƒçŸ¥è¯†
3. æ·±å…¥ **[æ–‡ä»¶ç»“æ„](./file-structure.md)** å­¦ä¹  ELF æ–‡ä»¶çš„å†…éƒ¨ç»„ç»‡
4. æ¢ç´¢ **[ç”¨æˆ·æŒ‡å—](../../user-guide/index.md)** äº†è§£ Gaia æ¡†æ¶åŠŸèƒ½

## æ€§èƒ½åŸºå‡†

### ç¼–è¯‘é€Ÿåº¦

- **å°å‹é¡¹ç›®** (< 1000 è¡Œ): < 100ms
- **ä¸­å‹é¡¹ç›®** (< 10000 è¡Œ): < 1s
- **å¤§å‹é¡¹ç›®** (< 100000 è¡Œ): < 10s

### è¿è¡Œæ—¶æ€§èƒ½

- **å¯åŠ¨æ—¶é—´**: ä¸ GCC ç”Ÿæˆçš„äºŒè¿›åˆ¶æ–‡ä»¶ç›¸å½“
- **æ‰§è¡Œé€Ÿåº¦**: åŸç”Ÿæœºå™¨ç ï¼Œæ— è§£é‡Šå¼€é”€
- **å†…å­˜å ç”¨**: ä¼˜åŒ–çš„å†…å­˜å¸ƒå±€å’Œå¯¹é½

### æ–‡ä»¶å¤§å°

- **æœ€å°å¯æ‰§è¡Œæ–‡ä»¶**: ~1KB (é™æ€é“¾æ¥)
- **å…¸å‹åº”ç”¨ç¨‹åº**: 10KB-1MB
- **å¤§å‹åº”ç”¨ç¨‹åº**: 1MB-100MB

---

*æœ¬æ–‡æ¡£æŒç»­æ›´æ–°ä¸­ï¼Œå¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œæ¬¢è¿æäº¤ Issue æˆ– Pull Requestã€‚*